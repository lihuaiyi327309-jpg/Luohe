<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>诺德工业 - 3D 交互选型</title>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        ::-webkit-scrollbar { width: 0px; background: transparent; }
        
        /* 1. 圆点样式 */
        .dot { 
            background: #3b82f6; width: 12px; height: 12px; border-radius: 50%; 
            border: 2px solid white; cursor: pointer; position: relative;
            box-shadow: 0 0 10px rgba(59, 130, 246, 0.8); 
            display: none; z-index: 999;
        }
        .dot.active { display: block !important; animation: popScale 0.4s ease-out; }
        
        /* 2. 介绍卡片 */
        .label { 
            display: none; background: rgba(255,255,255,0.98); border-radius: 10px; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.15); width: 220px; 
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); 
            z-index: 1000; overflow: hidden; border: 1px solid rgba(0,0,0,0.05);
            backdrop-filter: blur(10px); pointer-events: auto;
        }
        .label-header { background: #1e293b; color: white; padding: 8px 12px; font-weight: bold; font-size: 12px; display: flex; justify-content: space-between; }
        .label-body { padding: 12px; color: #64748b; font-size: 11px; line-height: 1.6; }
        .show-info .label { display: block; }

        /* 3. 右侧零件面板 */
        #parts-panel {
            position: absolute; right: 16px; top: 40%; transform: translateY(-50%);
            display: flex; flex-direction: column; gap: 10px; z-index: 50; opacity: 0; transition: all 0.5s; pointer-events: none;
        }
        #parts-panel.visible { opacity: 1; pointer-events: auto; }
        
        .part-btn {
            background: rgba(255,255,255,0.7); border: 1px solid rgba(255,255,255,0.5);
            backdrop-filter: blur(8px); width: 48px; height: 48px; border-radius: 14px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            font-size: 10px; font-weight: bold; color: #1e293b; transition: all 0.3s;
        }

        .selected-action {
            background: #1D1D1D !important;
            color: white !important;
            border-color: #333 !important;
            box-shadow: 0 8px 20px rgba(0,0,0,0.2) !important;
            transform: scale(1.02);
        }

        .part-btn.selected {
            background: #3b82f6 !important;
            color: white !important;
            border-color: #60a5fa;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
            transform: scale(1.08);
        }

        @keyframes popScale { from { transform: scale(0); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        
        #material-menu { transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); transform: translateY(-10px); opacity: 0; pointer-events: none; }
        #material-menu.active { transform: translateY(-20px); opacity: 1; pointer-events: auto; }
        .color-item { width: 34px; height: 34px; border-radius: 50%; border: 3px solid white; cursor: pointer; transition: transform 0.2s; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .color-item.selected { border-color: #1D1D1D; transform: scale(1.2); }
        .sticky-buy-bar { box-shadow: 0 -5px 20px rgba(0,0,0,0.05); z-index: 1001; }

        .product-card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .product-card:active { transform: scale(0.96); opacity: 0.8; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 overflow-x-hidden">

    <nav class="fixed top-0 inset-x-0 p-5 flex items-center justify-between z-[1002] pointer-events-none">
        <a href="index.html" class="w-10 h-10 bg-white/80 backdrop-blur-md rounded-full flex items-center justify-center shadow-sm border pointer-events-auto active:scale-90 transition-transform">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
        </a>
        <button onclick="alert('已收藏')" class="w-10 h-10 bg-white/80 backdrop-blur-md rounded-full flex items-center justify-center shadow-sm border pointer-events-auto active:scale-90 transition-transform">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path></svg>
        </button>
    </nav>

    <section class="relative w-full h-[75vh] bg-slate-50 z-10">
        <model-viewer id="main-model" 
            src="ovencf.glb" 
            poster="NuodeYULAN.png"
            camera-controls 
            auto-rotate
            camera-orbit="0deg 75deg auto"
            camera-target="0m 1m 0m"
            shadow-intensity="2" 
            exposure="1.2"
            class="w-full h-full outline-none">
            
            <button class="dot" id="dot-1" slot="hotspot-1" data-position="-0.3865m 2.8974m 0.4935m" data-normal="0m 1m 0m">
                <div class="label" onclick="event.stopPropagation()">
                    <div class="label-header"><span>鼓风电机</span><span class="opacity-50 text-[9px]">PART 01</span></div>
                    <div class="label-body">核心动力部件，专为工业高温环境设计，支持 24/7 不间断运行。</div>
                </div>
            </button>
            <button class="dot" id="dot-2" slot="hotspot-2" data-position="-1.8439m 1.9867m 0.2101m" data-normal="0m 1m 0m">
                <div class="label" onclick="event.stopPropagation()">
                    <div class="label-header"><span>加热组件</span><span class="opacity-50 text-[9px]">PART 02</span></div>
                    <div class="label-body">304不锈钢U型阵列排布，升温均匀，热效率提升35%。</div>
                </div>
            </button>
            <button class="dot" id="dot-3" slot="hotspot-3" data-position="-2.2856m 1.4417m 1.0262m" data-normal="0m 0m 1m">
                <div class="label" onclick="event.stopPropagation()">
                    <div class="label-header"><span>操作面板</span><span class="opacity-50 text-[9px]">PART 03</span></div>
                    <div class="label-body">PID 智能控温系统，支持多段工艺曲线编程。</div>
                </div>
            </button>

            <div id="parts-panel">
                <button onclick="triggerHotspot('dot-1')" class="part-btn shadow-sm">电机</button>
                <button onclick="triggerHotspot('dot-2')" class="part-btn shadow-sm">加热</button>
                <button onclick="triggerHotspot('dot-3')" class="part-btn shadow-sm">面板</button>
            </div>

            <div class="absolute bottom-12 left-12 right-12 flex flex-col pointer-events-none">
                <div id="material-menu" class="mb-4 p-3 bg-white/95 backdrop-blur-md rounded-2xl shadow-2xl flex justify-around border border-white/50 pointer-events-auto">
                    <div onclick="changeColor('#303030FF', this)" class="color-item selected" style="background: #303030;"></div>
                    <div onclick="changeColor('#384764FF', this)" class="color-item" style="background: #384764;"></div>
                    <div onclick="changeColor('#C3C1B9FF', this)" class="color-item" style="background: #C3C1B9;"></div>
                </div>

                <div class="flex gap-3 pointer-events-auto">
                    <button id="color-toggle-btn" onclick="toggleMatMenu()" class="flex-1 bg-white/80 backdrop-blur border border-slate-200 py-3.5 rounded-2xl font-bold shadow-sm transition-all text-xs flex items-center justify-center">
                        <span>颜色</span>
                    </button>
                    <button id="explode-btn" onclick="handleControl()" class="flex-1 bg-white/80 backdrop-blur border border-slate-200 text-slate-900 py-3.5 rounded-2xl font-bold shadow-sm transition-all active:scale-95 text-xs flex items-center justify-center">
                        <span id="explode-text">拆解</span>
                    </button>
                </div>
            </div>
        </model-viewer>
    </section>

    <section class="p-6 relative z-20 bg-white rounded-t-[32px] -mt-8 shadow-[0_-10px_40px_rgba(0,0,0,0.05)]">
        <div class="flex justify-between items-start mb-2">
            <div class="text-2xl font-black text-blue-600">¥ 8,500.00 <span class="text-sm font-normal text-slate-400">起</span></div>
            <div class="text-xs text-slate-400">月销 200+</div>
        </div>
        <h1 class="text-lg font-bold leading-tight mb-4 text-slate-800">诺德工业级热风循环风箱 - 高精度智能温控系列</h1>
    </section>

    <section>
        <div class="p-6 font-bold text-center text-slate-300 tracking-[0.2em] uppercase text-[10px]">— PRODUCT DETAILS —</div>
        <img src="Nuode.jpg" class="w-full h-auto" alt="详情图">
    </section>

    <section class="p-6 bg-slate-50 pb-32">
        <div class="flex items-center justify-between mb-6">
            <h2 class="text-lg font-black text-slate-800 relative inline-block">猜你喜欢<span class="absolute -bottom-1 left-0 w-8 h-1 bg-blue-600 rounded-full"></span></h2>
        </div>

        <div class="grid grid-cols-2 gap-4">
            <div class="product-card bg-white p-3 rounded-2xl shadow-sm border border-slate-100 flex flex-col">
                <div class="aspect-square bg-slate-50 rounded-xl mb-3 overflow-hidden">
                    <img src="product1.jpg" class="w-full h-full object-cover" onerror="this.src='https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?auto=format&fit=crop&w=300&q=80'">
                </div>
                <h3 class="text-xs font-bold text-slate-700 line-clamp-1 mb-1">诺德 X1 高温强化烘箱</h3>
                <div class="mt-auto flex justify-between items-center">
                    <span class="text-blue-600 font-black text-sm">¥ 12,800</span>
                </div>
            </div>
        </div>
    </section>

    <footer class="fixed bottom-0 inset-x-0 bg-white/95 backdrop-blur-xl border-t p-3 pb-8 flex items-center gap-4 sticky-buy-bar">
        <div class="flex-1 flex gap-2">
            <button onclick="alert('已加购')" class="flex-1 bg-slate-100 text-slate-900 py-3 rounded-full font-bold text-sm">加入购物车</button>
            <button onclick="alert('进入支付')" class="flex-1 bg-blue-600 text-white py-3 rounded-full font-bold text-sm shadow-lg">立即购买</button>
        </div>
    </footer>

    <script>
        const viewer = document.getElementById('main-model');
        const explodeBtn = document.getElementById('explode-btn');
        const explodeText = document.getElementById('explode-text');
        const colorToggleBtn = document.getElementById('color-toggle-btn');
        const matMenu = document.getElementById('material-menu');
        const partsPanel = document.getElementById('parts-panel');
        
        let currentStatus = "IDLE"; 
        const SPEED = 0.015;

        function updateLoop() {
            if (currentStatus === "EXPLODING") {
                if (viewer.currentTime < 0.98) {
                    viewer.currentTime += SPEED;
                    if(viewer.currentTime > 0.5) {
                        toggleDots(true);
                        partsPanel.classList.add('visible'); 
                    }
                } else {
                    viewer.currentTime = 0.999;
                    currentStatus = "LOCKED_END";
                    explodeText.innerText = "合并";
                }
            } else if (currentStatus === "COLLAPSING") {
                if (viewer.currentTime > 0.02) {
                    viewer.currentTime -= SPEED * 1.5;
                } else {
                    viewer.currentTime = 0;
                    currentStatus = "IDLE";
                    explodeText.innerText = "拆解";
                    explodeBtn.classList.remove('selected-action');
                    partsPanel.classList.remove('visible'); 
                    resetSelection();
                }
            }
            requestAnimationFrame(updateLoop);
        }

        function toggleDots(show) {
            document.querySelectorAll('.dot').forEach(dot => {
                if (show) dot.classList.add('active');
                else dot.classList.remove('active', 'show-info');
            });
        }

        function triggerHotspot(id) {
            const dot = document.getElementById(id);
            const isOpen = dot.classList.contains('show-info');
            document.querySelectorAll('.dot').forEach(el => el.classList.remove('show-info'));
            if (!isOpen) {
                dot.classList.add('show-info');
            }
        }

        function resetSelection() {
            document.querySelectorAll('.dot').forEach(el => el.classList.remove('show-info'));
        }

        function handleControl() {
            viewer.pause();
            if (!viewer.animationName && viewer.availableAnimations.length > 0) {
                viewer.animationName = viewer.availableAnimations[0];
            }
            matMenu.classList.remove('active');
            colorToggleBtn.classList.remove('selected-action');

            if (currentStatus === "IDLE" || currentStatus === "COLLAPSING") {
                currentStatus = "EXPLODING";
                explodeText.innerText = "进度...";
                explodeBtn.classList.add('selected-action');
            } else {
                toggleDots(false);
                currentStatus = "COLLAPSING";
                explodeText.innerText = "进度...";
            }
        }

        function toggleMatMenu() {
            const isActive = matMenu.classList.toggle('active');
            if(isActive) colorToggleBtn.classList.add('selected-action');
            else colorToggleBtn.classList.remove('selected-action');
        }

        function changeColor(hex, el) {
            const r = parseInt(hex.slice(1, 3), 16) / 255;
            const g = parseInt(hex.slice(3, 5), 16) / 255;
            const b = parseInt(hex.slice(5, 7), 16) / 255;
            const mat = viewer.model.materials.find(m => m.name.includes("HammerPaint") || m.name.includes("Switch"));
            if (mat) {
                mat.pbrMetallicRoughness.setBaseColorFactor([r, g, b, 1]);
                document.querySelectorAll('.color-item').forEach(c => c.classList.remove('selected'));
                el.classList.add('selected');
            }
        }

        viewer.addEventListener('load', () => {
            viewer.pause();
            requestAnimationFrame(updateLoop);
        });
    </script>
</body>
</html>